<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Final Project â€” W06 Tasks</title>
  <meta name="description" content="W06 Final Project demo: responsive layout, dark mode, JSON rendering, forms with localStorage, and sticky footer." />
  <meta property="og:title" content="Final Project â€” W06 Tasks" />
  <meta property="og:description" content="Responsive layout, dark mode, JSON rendering, forms with localStorage, and sticky footer." />
  <meta property="og:type" content="website" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Ctext y='80' x='10' font-size='80'%3E%F0%9F%9A%80%3C/text%3E%3C/svg%3E">
  <link rel="stylesheet" href="./style/style.css">
</head>
<body>
  <a class="sr-only" href="#main">Skip to content</a>

  <!-- ======= Header / Nav ======= -->
  <header>
    <div class="container nav-wrap">
      <div class="brand">
        <span class="logo">ðŸš€</span>
        <span>Final Project</span>
      </div>

      <nav aria-label="Primary">
        <button class="hamburger btn" id="menuBtn" aria-expanded="false" aria-controls="navList">â˜° <span class="sr-only">Menu</span></button>
        <ul id="navList">
          <li><a href="#home" data-nav>Home</a></li>
          <li><a href="#directory" data-nav>Directory</a></li>
          <li><a href="#review" data-nav>Review</a></li>
          <li><a href="#contact" data-nav>Contact</a></li>
          <li><a href="#references" data-nav>References</a></li>
        </ul>
      </nav>

      <div class="controls">
        <button class="btn" id="themeBtn" aria-pressed="false">ðŸŒ“ Theme</button>
      </div>
    </div>
  </header>

  <main id="main" class="container">
    <!-- ======= Home / Hero ======= -->
    <section id="home" class="hero" tabindex="-1">
      <div>
        <span class="tag">W06 Final Project â€¢ Demo Build</span>
        <h1>Responsive, Accessible, and Dynamic â€” all in one file</h1>
        <p class="helper">
          This demo covers: responsive layout, accessible navigation, dark mode with persistence,
          JSON rendering (directory), grid/list toggle, forms with validation & <code>localStorage</code>,
          lazy images, and a sticky footer.
        </p>
        <div class="grid cols-2">
          <a class="btn" href="#directory">View Directory</a>
          <a class="btn" href="#review">Leave a Review</a>
        </div>
      </div>
      <figure class="card">
        <img loading="lazy" width="960" height="640"
             src="https://images.unsplash.com/photo-1495020689067-958852a7765e?q=80&w=1200&auto=format&fit=crop"
             alt="Abstract gradient shapes and code-themed background" />
        <figcaption class="helper">Image is lazy-loaded and has intrinsic dimensions to prevent CLS.</figcaption>
      </figure>
    </section>

    <!-- ======= Directory (JSON â†’ Cards) ======= -->
    <section id="directory" class="card" aria-labelledby="dir-title" tabindex="-1">
      <div class="toolbar">
        <h2 id="dir-title" style="margin:0">Directory</h2>
        <div class="toggle" role="group" aria-label="View toggle">
          <button class="btn" id="gridBtn" aria-pressed="true">â–¦ Grid</button>
          <button class="btn" id="listBtn" aria-pressed="false">â˜° List</button>
        </div>
      </div>
      <div id="dirWrap" class="directory" aria-live="polite"></div>
    </section>

    <!-- ======= Review Form ======= -->
    <section id="review" class="card" aria-labelledby="review-title" tabindex="-1">
      <h2 id="review-title" style="margin-top:0">Product Review</h2>
      <p class="helper">Dropdown options are populated via JavaScript. Submissions are counted in <code>localStorage</code>.</p>

      <form id="reviewForm" novalidate>
        <div>
          <label for="product">Product</label>
          <select id="product" required>
            <option value="" selected disabled>Select a productâ€¦</option>
          </select>
          <div class="helper">Required</div>
        </div>

        <div>
          <label for="rating">Rating (1â€“5)</label>
          <input id="rating" type="number" min="1" max="5" inputmode="numeric" required />
        </div>

        <div>
          <label for="reviewText">Your Review</label>
          <textarea id="reviewText" placeholder="What did you like? What could be better?" required></textarea>
        </div>

        <div>
          <button class="btn" type="submit">Submit Review</button>
          <span id="reviewMsg" class="helper" role="status" aria-live="polite"></span>
        </div>
      </form>
    </section>

    <!-- ======= Contact Form ======= -->
    <section id="contact" class="card" aria-labelledby="contact-title" tabindex="-1">
      <h2 id="contact-title" style="margin-top:0">Contact Us</h2>
      <p class="helper">Drafts auto-save locally so you donâ€™t lose your message.</p>

      <form id="contactForm" novalidate>
        <div>
          <label for="name">Name</label>
          <input id="name" name="name" autocomplete="name" required />
        </div>
        <div>
          <label for="email">Email</label>
          <input id="email" name="email" type="email" autocomplete="email" required />
        </div>
        <div>
          <label for="message">Message</label>
          <textarea id="message" name="message" required></textarea>
        </div>
        <div>
          <button class="btn" type="submit">Send</button>
          <span id="contactMsg" class="helper" role="status" aria-live="polite"></span>
        </div>
      </form>
    </section>

    <!-- ======= References ======= -->
    <section id="references" class="card" aria-labelledby="ref-title" tabindex="-1">
      <h2 id="ref-title" style="margin-top:0">References</h2>
      <ul>
        <li>Accessibility: semantic landmarks, labels, focusable section headings, color contrast.</li>
        <li>Performance: lazy images, intrinsic dimensions, minimal JS, no external libs.</li>
        <li>State & Storage: theme + view preferences + counters saved to <code>localStorage</code>.</li>
      </ul>

      <details>
        <summary>Task Links</summary>
        <ul>
          <li><strong>Repo (Source):</strong> https://github.com/edwinadiele/wdd330/blob/main/final-project/input.html</li>
          <li><strong>Live Site:</strong> https://edwinadiele.github.io/wdd330/final-project/input.html</li>
          <li><strong>Trello Board:</strong> https://trello.com/b/999999/yourprojecttitle</li>
        </ul>
      </details>
    </section>
  </main>

  <!-- ======= Footer (Sticky to bottom) ======= -->
  <footer>
    <div class="container">
      <small>Â© <span id="year"></span> Adiele Edwin Obinna â€¢ Final Project â€¢ All rights reserved.</small>
    </div>
  </footer>

  <!-- ======= Inline JSON data for Directory ======= -->
  <script type="application/json" id="directoryData">
  [
    {
      "name": "Nebula Tech",
      "category": "Software",
      "location": "Lagos, Nigeria",
      "logo": "https://images.unsplash.com/photo-1521737604893-d14cc237f11d?q=80&w=256&auto=format&fit=crop",
      "website": "https://example.com"
    },
    {
      "name": "Coastal Cafe",
      "category": "Food & Drink",
      "location": "Owerri, Nigeria",
      "logo": "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?q=80&w=256&auto=format&fit=crop",
      "website": "https://example.com"
    },
    {
      "name": "GreenPeak Studio",
      "category": "Design",
      "location": "Abuja, Nigeria",
      "logo": "https://images.unsplash.com/photo-1526318472351-c75fcf070305?q=80&w=256&auto=format&fit=crop",
      "website": "https://example.com"
    },
    {
      "name": "Savanna Fitness",
      "category": "Health",
      "location": "Port Harcourt, Nigeria",
      "logo": "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=256&auto=format&fit=crop",
      "website": "https://example.com"
    }
  ]
  </script>

  <!-- ======= App Scripts ======= -->
  <script>
    // ---------- Utilities ----------
    const $ = sel => document.querySelector(sel);
    const $$ = sel => document.querySelectorAll(sel);

    // ---------- Theme (Dark / Light) ----------
    (function initTheme(){
      const root = document.documentElement;
      const saved = localStorage.getItem('theme');
      const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
      if(saved === 'light' || (!saved && prefersLight)) root.classList.add('light');

      const btn = $('#themeBtn');
      const setPressed = () => btn.setAttribute('aria-pressed', root.classList.contains('light') ? 'true' : 'false');
      setPressed();

      btn.addEventListener('click', () => {
        root.classList.toggle('light');
        localStorage.setItem('theme', root.classList.contains('light') ? 'light' : 'dark');
        setPressed();
      });
    })();

    // ---------- Nav / Hamburger / Current section highlight ----------
    (function initNav(){
      const menuBtn = $('#menuBtn');
      const navList = $('#navList');
      menuBtn.addEventListener('click', () => {
        const open = navList.classList.toggle('open');
        menuBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
      });

      // Close menu on link click (mobile)
      navList.addEventListener('click', e => {
        if(e.target.matches('a[data-nav]')) {
          navList.classList.remove('open');
          menuBtn.setAttribute('aria-expanded','false');
        }
      });

      // Highlight current link on hash change
      function updateActive(){
        const hash = window.location.hash || '#home';
        $$('a[data-nav]').forEach(a => a.setAttribute('aria-current', a.getAttribute('href') === hash ? 'page' : 'false'));
      }
      window.addEventListener('hashchange', updateActive);
      updateActive();
    })();

    // ---------- Year in Footer ----------
    $('#year').textContent = new Date().getFullYear();

    // ---------- Directory: Render from JSON + View toggle ----------
    (function initDirectory(){
      const wrap = $('#dirWrap');
      const dataEl = $('#directoryData');
      let items = [];
      try { items = JSON.parse(dataEl.textContent.trim()); } catch(e){ items = []; }

      function makeCard(item){
        const div = document.createElement('article');
        div.className = 'item';
        div.innerHTML = `
          <img loading="lazy" alt="${item.name} logo" src="${item.logo}" width="64" height="64">
          <div>
            <strong>${item.name}</strong><br>
            <span class="meta">${item.location}</span><br>
            <span class="badge">${item.category}</span>
          </div>
          <div style="justify-self:end">
            <a class="btn" href="${item.website}" target="_blank" rel="noopener">Visit</a>
          </div>
        `;
        return div;
      }

      function render(){
        wrap.innerHTML = '';
        items.forEach(it => wrap.appendChild(makeCard(it)));
      }

      render();

      // View toggle with persistence
      const gridBtn = $('#gridBtn');
      const listBtn = $('#listBtn');
      const saved = localStorage.getItem('directoryView') || 'grid';
      setView(saved);

      function setView(view){
        if(view === 'list'){ wrap.classList.add('list'); }
        else { wrap.classList.remove('list'); }
        localStorage.setItem('directoryView', view);
        gridBtn.setAttribute('aria-pressed', view === 'grid' ? 'true' : 'false');
        listBtn.setAttribute('aria-pressed', view === 'list' ? 'true' : 'false');
      }

      gridBtn.addEventListener('click', () => setView('grid'));
      listBtn.addEventListener('click', () => setView('list'));
    })();

    // ---------- Review Form: populate dropdown, validate, count submissions ----------
    (function initReviewForm(){
      const products = [
        { id:'p1', name:'Nebula OS' },
        { id:'p2', name:'Coastal Beans' },
        { id:'p3', name:'GreenPeak Kit' },
        { id:'p4', name:'Savanna Band' },
      ];
      const select = $('#product');
      products.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.id; opt.textContent = p.name;
        select.appendChild(opt);
      });

      const form = $('#reviewForm');
      const rating = $('#rating');
      const text = $('#reviewText');
      const msg = $('#reviewMsg');

      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        msg.className = 'helper';

        // Validation
        if(!select.value){ return showError('Please choose a product.'); }
        const r = Number(rating.value);
        if(!Number.isFinite(r) || r < 1 || r > 5){ return showError('Rating must be a number from 1 to 5.'); }
        if(text.value.trim().length < 10){ return showError('Please write at least 10 characters.'); }

        // Count submissions
        const count = Number(localStorage.getItem('reviewCount') || '0') + 1;
        localStorage.setItem('reviewCount', String(count));

        // Simulated "save"
        form.reset();
        msg.className = 'success';
        msg.textContent = `Thanks! Your review was recorded. Total submissions on this device: ${count}.`;
      });

      function showError(t){
        msg.className = 'error';
        msg.textContent = t;
      }
    })();

    // ---------- Contact Form: auto-save draft + confirmation ----------
    (function initContactForm(){
      const form = $('#contactForm');
      const msg = $('#contactMsg');

      // Restore draft
      const draft = JSON.parse(localStorage.getItem('contactDraft') || '{}');
      if(draft.name) $('#name').value = draft.name;
      if(draft.email) $('#email').value = draft.email;
      if(draft.message) $('#message').value = draft.message;

      form.addEventListener('input', ()=>{
        const data = {
          name: $('#name').value.trim(),
          email: $('#email').value.trim(),
          message: $('#message').value.trim()
        };
        localStorage.setItem('contactDraft', JSON.stringify(data));
      });

      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        // naive validation
        if(!$('#name').value.trim() || !$('#email').value.trim() || !$('#message').value.trim()){
          msg.className = 'error';
          msg.textContent = 'Please fill out all fields.';
          return;
        }
        // Simulate "send"
        localStorage.removeItem('contactDraft');
        form.reset();
        msg.className = 'success';
        msg.textContent = 'Thanks! Your message has been sent (simulated).';
      });
    })();

    // ---------- Scroll to section on first load ----------
    if(!location.hash) location.hash = '#home';
  </script>
</body>
</html>
